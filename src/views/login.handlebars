<h1>Login</h1>
<form action="/api/sessions/login" method="POST" id="loginForm">
    <label for="email">Email:</label>
    <input type="email" id="email" name="email" required>
    <br>
    <label for="password">Password:</label>
    <input type="password" id="password" name="password" required>
    <br>
    <button type="submit">Login</button>
</form>

<a href="/api/sessions/github"> <button> GITHUB </button> </a>

<p>No tienes una cuenta? <a href="/register">Regístrate aquí</a>.</p>

<script>
    console.log("Valor de session.login:", {{ session.login }});
</script>

<script>
document.getElementById('loginForm').addEventListener('submit', async (event) => {
    event.preventDefault();
    
    const formData = new FormData(event.target);
    const email = formData.get('email');
    const password = formData.get('password');

    const response = await fetch('/api/sessions/login', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ email, password })
    });

    const data = await response.json();

    if (response.ok) {
        Swal.fire({
            icon: 'success',
            title: 'Inicio de sesión exitoso',
            text: data.message,
            timer: 2000,
            showConfirmButton: false
        }).then(() => {
            window.location.href = '/profile';
        });
    } else {
        Swal.fire({
            icon: 'error',
            title: 'Error de inicio de sesión',
            text: data.error,
            timer: 3000,
            showConfirmButton: false
        });
    }
});
</script>
